2025-07-17 16:25:45,166 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 16:25:45,166 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 16:34:45,727 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 16:34:45,728 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:05:16,981 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:05:16,982 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:06:12,206 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:06:12,206 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:06:41,912 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:06:41,912 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:09:59,617 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:09:59,617 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:10:48,501 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:10:48,501 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:38:21,580 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:38:21,580 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:41:11,996 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:41:11,997 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-17 17:43:27,212 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-17 17:43:27,212 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 09:46:16,339 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 09:46:16,339 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 09:48:33,412 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 09:48:33,413 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 09:52:58,385 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 09:52:58,385 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 09:55:11,434 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 09:55:11,435 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 09:56:24,906 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 09:56:24,906 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 10:00:39,935 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 10:00:39,936 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 10:08:24,261 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 10:08:24,261 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 10:09:02,010 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 10:09:02,010 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 10:11:03,015 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 10:11:03,015 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 10:20:54,816 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 10:20:54,816 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:32:28,492 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:32:28,493 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:40:29,743 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:40:29,743 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:49:26,801 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:49:26,802 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:50:28,734 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:50:28,734 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:55:05,364 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:55:05,365 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 12:59:33,126 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 12:59:33,127 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 13:04:05,419 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 13:04:05,419 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 13:06:25,027 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 13:06:25,027 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 15:49:03,929 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 15:49:03,930 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:06:22,058 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:06:22,058 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:33:52,374 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:33:52,374 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:35:00,230 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:35:00,231 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:38:33,313 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:38:33,314 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:45:39,090 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:45:39,090 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:49:32,412 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:49:32,412 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-18 16:51:10,744 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-18 16:51:10,744 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-19 10:45:18,874 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-19 10:45:18,875 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-20 18:19:07,130 - Tests - ERROR - (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 44, in test_news_ganres_to_queue
    news_game_from_ganre(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 51, in news_game_from_ganre
    data = news_service.game_from_ganre(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 120, in game_from_ganre
    return self.get_game_from_ganre_name_use_case.execute(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_game_from_ganre_name_use_case.py", line 12, in execute
    data = self.news_repository.get_game_from_ganre_name(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 80, in get_game_from_ganre_name
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-20 18:19:07,334 - Tests - ERROR - (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 44, in test_news_ganres_to_queue
    news_game_from_ganre(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 51, in news_game_from_ganre
    data = news_service.game_from_ganre(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 120, in game_from_ganre
    return self.get_game_from_ganre_name_use_case.execute(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_game_from_ganre_name_use_case.py", line 12, in execute
    data = self.news_repository.get_game_from_ganre_name(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 80, in get_game_from_ganre_name
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-20 18:19:07,540 - Tests - ERROR - (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 44, in test_news_ganres_to_queue
    news_game_from_ganre(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 51, in news_game_from_ganre
    data = news_service.game_from_ganre(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 120, in game_from_ganre
    return self.get_game_from_ganre_name_use_case.execute(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_game_from_ganre_name_use_case.py", line 12, in execute
    data = self.news_repository.get_game_from_ganre_name(ganre_name=ganre_name,session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 80, in get_game_from_ganre_name
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) ПОМИЛКА:  не вдалося визначити оператора рівності для типу json
LINE 2: ...esdetails.short_description AS short_description, gamesdetai...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT DISTINCT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN steambase ON CAST(steambase.appid AS INTEGER) = gamesdetails.steam_appid JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE (categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND steambase.positive - steambase.negative >= %(param_1)s AND gamesdetails.release_data >= %(release_data_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'param_1': 2000, 'release_data_1': datetime.date(2020, 1, 1), 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-20 19:08:01,876 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-20 19:08:01,877 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-20 19:25:31,704 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-20 19:25:31,704 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-20 19:49:36,415 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-20 19:49:36,415 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-20 19:50:09,828 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-20 19:50:09,828 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-21 11:40:37,838 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-21 11:51:52,263 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-21 12:02:31,060 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-21 13:18:21,313 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-21 13:18:21,313 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 12:56:35,582 - Tests - INFO - {'steam_appid': 76561199054741771, 'user_rating': 4618, 'personaname': 'RAT | Vaznia', 'player_level': 13, 'player_xp': 1759, 'player_xp_needed_to_level_up': 41, 'timecreated': 1588662836, 'timelive': 164601759.58112097, 'friends_count': 12, 'badges_count': 13, 'lastlogoff': 1752683068, 'playtime': 310242, 'allow_games': True, 'allow_friends': True, 'allow_badges': True}
2025-07-23 12:57:31,534 - Tests - CRITICAL - {'detail': 'Steam game not found'}
2025-07-23 12:59:19,149 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 12:59:23,180 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 12:59:23,181 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 14:43:22,612 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 14:43:25,443 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 14:43:25,443 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 14:45:19,347 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 14:45:22,359 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 14:45:22,359 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 14:47:50,933 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 14:47:53,647 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 14:47:53,647 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 14:48:31,079 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 14:48:34,231 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 14:48:34,231 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:12:17,627 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 15:12:21,097 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:12:21,097 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:13:28,556 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 15:13:31,824 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:13:31,824 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:25:19,493 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 15:25:22,620 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:25:22,621 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:35:28,570 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 15:35:32,496 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:35:32,496 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:41:23,231 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:41:23,231 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:41:59,229 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:41:59,230 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:45:03,767 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:45:03,767 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:46:24,239 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:46:24,239 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-23 15:48:41,219 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-23 15:48:44,034 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-23 15:48:44,034 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 12:42:20,710 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:44:47,690 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:47:27,062 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:50:12,421 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:51:16,221 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:58:13,654 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 12:58:35,492 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:33:19,129 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:33:53,365 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:34:03,385 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:34:23,684 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:34:57,820 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DatatypeMismatch: ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 124, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 101, in random_game
    return self.random_game_sync_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\news_use_cases\get_sync_random_game.py", line 12, in execute
    data = self.news_repository.random_game_from_price(session=session,limit=1,price=200)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 73, in random_game_from_price
    result = session.execute(statement)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.DatatypeMismatch) ПОМИЛКА:  аргумент конструкції AND повинен бути типу boolean, не типу integer
LINE 4: ...голення')) AND gamesdetails.final_price > 200 AND CAST(games...
                                                             ^

[SQL: SELECT anon_1.steam_appid, anon_1.name, anon_1.is_free, anon_1.short_description, anon_1.requirements, anon_1.initial_price, anon_1.final_price, anon_1.final_formatted_price, anon_1.metacritic, anon_1.discount, anon_1.achievements, anon_1.recomendations, anon_1.img_url, anon_1.trailer_url, anon_1.release_data, anon_1.last_updated, anon_1.random_1, ganres_1.ganres_id, ganres_1.ganres_name, publishers_1.publisher_id, publishers_1.publisher_name, categories_1.category_id, categories_1.category_name 
FROM (SELECT gamesdetails.steam_appid AS steam_appid, gamesdetails.name AS name, gamesdetails.is_free AS is_free, gamesdetails.short_description AS short_description, gamesdetails.requirements AS requirements, gamesdetails.initial_price AS initial_price, gamesdetails.final_price AS final_price, gamesdetails.final_formatted_price AS final_formatted_price, gamesdetails.metacritic AS metacritic, gamesdetails.discount AS discount, gamesdetails.achievements AS achievements, gamesdetails.recomendations AS recomendations, gamesdetails.img_url AS img_url, gamesdetails.trailer_url AS trailer_url, gamesdetails.release_data AS release_data, gamesdetails.last_updated AS last_updated, random() AS random_1 
FROM gamesdetails JOIN ganre_to_many AS ganre_to_many_1 ON gamesdetails.steam_appid = ganre_to_many_1.game_id JOIN ganres AS ganres_2 ON ganres_2.ganres_id = ganre_to_many_1.ganre_id JOIN category_to_many AS category_to_many_1 ON gamesdetails.steam_appid = category_to_many_1.game_id JOIN categories AS categories_2 ON categories_2.category_id = category_to_many_1.category_id 
WHERE ((categories_2.category_name NOT IN (%(category_name_1_1)s)) AND (ganres_2.ganres_name NOT IN (%(ganres_name_1_1)s, %(ganres_name_1_2)s)) AND gamesdetails.final_price > %(final_price_1)s AND CAST(gamesdetails.metacritic AS INTEGER)) >= %(param_1)s ORDER BY random() 
 LIMIT %(param_2)s) AS anon_1 LEFT OUTER JOIN (ganre_to_many AS ganre_to_many_2 JOIN ganres AS ganres_1 ON ganres_1.ganres_id = ganre_to_many_2.ganre_id) ON anon_1.steam_appid = ganre_to_many_2.game_id LEFT OUTER JOIN (publisher_to_many AS publisher_to_many_1 JOIN publishers AS publishers_1 ON publishers_1.publisher_id = publisher_to_many_1.publisher_id) ON anon_1.steam_appid = publisher_to_many_1.game_id LEFT OUTER JOIN (category_to_many AS category_to_many_2 JOIN categories AS categories_1 ON categories_1.category_id = category_to_many_2.category_id) ON anon_1.steam_appid = category_to_many_2.game_id ORDER BY anon_1.random_1]
[parameters: {'final_price_1': 200, 'param_1': 70, 'param_2': 1, 'category_name_1_1': 'Демоверсія гри', 'ganres_name_1_1': 'Сексуальний вміст', 'ganres_name_1_2': 'Оголення'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 31, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 128, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-26 13:42:34,412 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:42:34,413 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:44:07,681 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:44:07,681 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:45:09,627 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:45:09,627 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:47:44,216 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:47:44,216 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:47:59,504 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:47:59,504 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:49:42,924 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:49:42,924 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-26 13:57:51,572 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-26 13:57:51,572 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:27:18,919 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:27:18,920 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:40:20,678 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:40:20,679 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:44:32,008 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:44:32,008 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:47:03,062 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:47:03,063 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:48:22,166 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:48:22,167 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:50:33,885 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:50:33,886 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 12:57:03,607 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 12:57:03,607 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:00:26,671 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:00:26,671 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:11:44,881 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:11:44,881 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:14:23,797 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:14:23,797 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:26:26,820 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:26:26,820 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:27:20,061 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:27:20,061 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:28:05,988 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:28:05,989 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:29:49,869 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:29:49,869 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:31:10,612 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:31:10,613 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:32:19,996 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:32:19,996 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:45:31,201 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:45:31,201 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:54:30,862 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:54:30,862 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:56:08,706 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:56:08,707 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:57:53,961 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:57:53,961 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 13:58:39,246 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 13:58:39,247 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:04:42,229 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:04:42,229 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:09:24,892 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:09:24,892 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:10:07,144 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:10:07,144 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:14:22,091 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:14:22,091 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:15:07,411 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:15:07,412 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:19:35,775 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:19:35,775 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:19:47,235 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:19:47,236 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:21:16,792 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:21:16,792 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:22:17,373 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:22:17,373 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:23:09,212 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:23:09,213 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:26:06,172 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:26:06,172 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:29:09,191 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:29:09,192 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 14:55:22,641 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 14:55:22,641 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 15:00:08,098 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 15:00:08,100 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-27 15:01:57,524 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-27 15:01:57,524 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-28 15:31:02,033 - Tests - INFO - {'steam_appid': 76561199054741771, 'user_rating': 4710, 'personaname': 'RAT | Vaznia', 'player_level': 13, 'player_xp': 1759, 'player_xp_needed_to_level_up': 41, 'timecreated': 1588662836, 'timelive': 165043026.03122997, 'friends_count': 12, 'badges_count': 13, 'lastlogoff': 1753704844, 'playtime': 313602, 'allow_games': True, 'allow_friends': True, 'allow_badges': True}
2025-07-28 15:32:38,207 - Tests - CRITICAL - {'detail': 'Steam game not found'}
2025-07-28 15:35:29,742 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-28 15:35:29,743 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-28 15:36:28,995 - Tests - INFO - response: 200
2025-07-28 15:36:28,995 - Tests - INFO - {'user_data': {'player': {'steamid': 76561199028668211, 'personaname': 'floyse{fake}', 'avatarfull': 'https://avatars.steamstatic.com/be88d2493ccbd52b21cfc0a73b7320d3c67de32a_full.jpg', 'personastate': 0, 'communityvisibilitystate': 3, 'profilestate': 1, 'lastlogoff': 1753466560, 'realname': None, 'primaryclanid': 103582791429521408, 'timecreated': 1582305861, 'timelive': 171400327.99262404, 'gameid': None, 'gameextrainfo': None, 'loccountrycode': None}}, 'user_friends_list': {'friends_count': 21, 'first_friend': {'steamid': '76561198403798416', 'relationship': 'friend', 'friend_since': 1623681105}, 'last_friend': {'steamid': '76561199840394425', 'relationship': 'friend', 'friend_since': 1746632140}, 'friends': [{'steamid': '76561198983557642', 'relationship': 'friend', 'friend_since': 1664285092}, {'steamid': '76561199054741771', 'relationship': 'friend', 'friend_since': 1670144518}, {'steamid': '76561199093545741', 'relationship': 'friend', 'friend_since': 1629129097}, {'steamid': '76561199139536554', 'relationship': 'friend', 'friend_since': 1626003134}, {'steamid': '76561199205637375', 'relationship': 'friend', 'friend_since': 1641280796}, {'steamid': '76561198403798416', 'relationship': 'friend', 'friend_since': 1623681105}, {'steamid': '76561199187929884', 'relationship': 'friend', 'friend_since': 1634835460}, {'steamid': '76561198973182364', 'relationship': 'friend', 'friend_since': 1740393929}, {'steamid': '76561199840394425', 'relationship': 'friend', 'friend_since': 1746632140}, {'steamid': '76561198131826041', 'relationship': 'friend', 'friend_since': 1634229896}, {'steamid': '76561198144270080', 'relationship': 'friend', 'friend_since': 1740394008}, {'steamid': '76561199047609617', 'relationship': 'friend', 'friend_since': 1628146063}, {'steamid': '76561199667157069', 'relationship': 'friend', 'friend_since': 1723053274}, {'steamid': '76561199050943641', 'relationship': 'friend', 'friend_since': 1626867276}, {'steamid': '76561198973031339', 'relationship': 'friend', 'friend_since': 1724915595}, {'steamid': '76561199082273404', 'relationship': 'friend', 'friend_since': 1630336664}, {'steamid': '76561199049138403', 'relationship': 'friend', 'friend_since': 1628189514}, {'steamid': '76561199008491614', 'relationship': 'friend', 'friend_since': 1630336661}, {'steamid': '76561199059603519', 'relationship': 'friend', 'friend_since': 1644058104}, {'steamid': '76561199190491252', 'relationship': 'friend', 'friend_since': 1626785731}, {'steamid': '76561199091610834', 'relationship': 'friend', 'friend_since': 1628706469}]}, 'user_badges': {'badges': [{'badgeid': 13, 'level': 44, 'completion_time': 1752672942, 'xp': 238, 'scarcity': 41756440}, {'badgeid': 68, 'level': 1, 'completion_time': 1735240787, 'xp': 50, 'scarcity': 33683574}, {'badgeid': 66, 'level': 1, 'completion_time': 1703170405, 'xp': 50, 'scarcity': 39186327}, {'badgeid': 64, 'level': 1, 'completion_time': 1675532941, 'xp': 50, 'scarcity': 78744514}, {'badgeid': 2, 'level': 1, 'completion_time': 1640694988, 'xp': 100, 'scarcity': 90256858}, {'badgeid': 1, 'level': 5, 'completion_time': 1582305861, 'xp': 250, 'scarcity': 216368139}], 'player_xp': 738, 'player_level': 7, 'player_xp_needed_to_level_up': 62, 'player_xp_needed_current_level': 700}, 'user_games': {'game_count': 108, 'games': [{'appid': 4000, 'name': "Garry's Mod", 'playtime_forever': 761, 'playtime_2weeks': None, 'rtime_last_played': 1726336839}, {'appid': 550, 'name': 'Left 4 Dead 2', 'playtime_forever': 1036, 'playtime_2weeks': None, 'rtime_last_played': 1703099400}, {'appid': 620, 'name': 'Portal 2', 'playtime_forever': 155, 'playtime_2weeks': None, 'rtime_last_played': 1672770885}, {'appid': 105600, 'name': 'Terraria', 'playtime_forever': 140, 'playtime_2weeks': None, 'rtime_last_played': 1714163905}, {'appid': 99900, 'name': 'Spiral Knights', 'playtime_forever': 147, 'playtime_2weeks': None, 'rtime_last_played': 1648378927}, {'appid': 223710, 'name': 'Cry of Fear', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 224260, 'name': 'No More Room in Hell', 'playtime_forever': 31, 'playtime_2weeks': None, 'rtime_last_played': 1708870382}, {'appid': 253710, 'name': 'theHunter Classic', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 242760, 'name': 'The Forest', 'playtime_forever': 3410, 'playtime_2weeks': None, 'rtime_last_played': 1735833250}, {'appid': 218620, 'name': 'PAYDAY 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 251570, 'name': '7 Days to Die', 'playtime_forever': 3621, 'playtime_2weeks': None, 'rtime_last_played': 1738349314}, {'appid': 225840, 'name': 'Sven Co-op', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 730, 'name': 'Counter-Strike 2', 'playtime_forever': 61351, 'playtime_2weeks': 316, 'rtime_last_played': 1753461128}, {'appid': 332950, 'name': 'Dark Deception', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 333420, 'name': 'Cossacks 3', 'playtime_forever': 1457, 'playtime_2weeks': None, 'rtime_last_played': 1739557922}, {'appid': 346330, 'name': 'BrainBread 2', 'playtime_forever': 64, 'playtime_2weeks': None, 'rtime_last_played': 1648293297}, {'appid': 232090, 'name': 'Killing Floor 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 322330, 'name': "Don't Starve Together", 'playtime_forever': 157, 'playtime_2weeks': None, 'rtime_last_played': 1721743691}, {'appid': 380600, 'name': 'Fishing Planet', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 383150, 'name': 'Dead Island Definitive Edition', 'playtime_forever': 953, 'playtime_2weeks': None, 'rtime_last_played': 1685554801}, {'appid': 383180, 'name': 'Dead Island Riptide Definitive Edition', 'playtime_forever': 101, 'playtime_2weeks': None, 'rtime_last_played': 1705843454}, {'appid': 291550, 'name': 'Brawlhalla', 'playtime_forever': 2048, 'playtime_2weeks': None, 'rtime_last_played': 1741025958}, {'appid': 387990, 'name': 'Scrap Mechanic', 'playtime_forever': 3800, 'playtime_2weeks': None, 'rtime_last_played': 1723402414}, {'appid': 397900, 'name': 'Business Tour - Online Multiplayer Board Game', 'playtime_forever': 92, 'playtime_2weeks': None, 'rtime_last_played': 1701544995}, {'appid': 378370, 'name': 'Nomad', 'playtime_forever': 33, 'playtime_2weeks': None, 'rtime_last_played': 1638377958}, {'appid': 513000, 'name': 'Kuboom', 'playtime_forever': 535, 'playtime_2weeks': None, 'rtime_last_played': 1650366029}, {'appid': 289070, 'name': "Sid Meier's Civilization VI", 'playtime_forever': 19, 'playtime_2weeks': None, 'rtime_last_played': 1677855122}, {'appid': 563560, 'name': 'Alien Swarm: Reactive Drop', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 582500, 'name': 'We Were Here', 'playtime_forever': 142, 'playtime_2weeks': None, 'rtime_last_played': 1713694748}, {'appid': 588220, 'name': "Tom Clancy's The Division Trial", 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 588430, 'name': 'Fallout Shelter', 'playtime_forever': 1089, 'playtime_2weeks': None, 'rtime_last_played': 1647181733}, {'appid': 632810, 'name': 'Soundpad Demo', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 386180, 'name': 'Crossout', 'playtime_forever': 232, 'playtime_2weeks': None, 'rtime_last_played': 1678902970}, {'appid': 648800, 'name': 'Raft', 'playtime_forever': 860, 'playtime_2weeks': None, 'rtime_last_played': 1706453445}, {'appid': 673560, 'name': 'IOSoccer', 'playtime_forever': 8, 'playtime_2weeks': None, 'rtime_last_played': 1720539833}, {'appid': 304930, 'name': 'Unturned', 'playtime_forever': 148, 'playtime_2weeks': None, 'rtime_last_played': 1688551490}, {'appid': 240720, 'name': 'Getting Over It with Bennett Foddy', 'playtime_forever': 15, 'playtime_2weeks': None, 'rtime_last_played': 1741023708}, {'appid': 700330, 'name': 'SCP: Secret Laboratory', 'playtime_forever': 19, 'playtime_2weeks': None, 'rtime_last_played': 1679919100}, {'appid': 736590, 'name': 'Operation: Harsh Doorstop', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 587860, 'name': 'Tales of Escape', 'playtime_forever': 6, 'playtime_2weeks': None, 'rtime_last_played': 1718107422}, {'appid': 763230, 'name': 'Fruity Smoothie', 'playtime_forever': 6, 'playtime_2weeks': None, 'rtime_last_played': 1676739257}, {'appid': 764570, 'name': 'Beavers Be Dammed', 'playtime_forever': 10, 'playtime_2weeks': None, 'rtime_last_played': 1708182293}, {'appid': 792220, 'name': 'Paunch', 'playtime_forever': 24, 'playtime_2weeks': None, 'rtime_last_played': 1724860972}, {'appid': 252490, 'name': 'Rust', 'playtime_forever': 1142, 'playtime_2weeks': None, 'rtime_last_played': 1725112118}, {'appid': 815370, 'name': 'Green Hell', 'playtime_forever': 507, 'playtime_2weeks': None, 'rtime_last_played': 1735489858}, {'appid': 552520, 'name': 'Far Cry 5', 'playtime_forever': 1769, 'playtime_2weeks': None, 'rtime_last_played': 1736258669}, {'appid': 312670, 'name': 'Strange Brigade', 'playtime_forever': 227, 'playtime_2weeks': None, 'rtime_last_played': 1699203962}, {'appid': 859570, 'name': 'Secret Neighbor', 'playtime_forever': 10, 'playtime_2weeks': None, 'rtime_last_played': 1685548525}, {'appid': 871720, 'name': 'Ultimate Custom Night', 'playtime_forever': 1, 'playtime_2weeks': None, 'rtime_last_played': 1626335782}, {'appid': 893520, 'name': 'CreativeDestruction', 'playtime_forever': 64, 'playtime_2weeks': None, 'rtime_last_played': 1648741043}, {'appid': 977400, 'name': 'Cell to Singularity - Evolution Never Ends', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 1016920, 'name': 'Unrailed!', 'playtime_forever': 40, 'playtime_2weeks': None, 'rtime_last_played': 1687370895}, {'appid': 1044200, 'name': 'Wasteland Survival', 'playtime_forever': 53, 'playtime_2weeks': None, 'rtime_last_played': 1647271052}, {'appid': 1049800, 'name': 'BLOCKADE ', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 219830, 'name': "King Arthur's Gold", 'playtime_forever': 15, 'playtime_2weeks': None, 'rtime_last_played': 1639762252}, {'appid': 761890, 'name': 'Albion Online', 'playtime_forever': 498, 'playtime_2weeks': None, 'rtime_last_played': 1660915719}, {'appid': 1128810, 'name': 'RISK: Global Domination', 'playtime_forever': 49, 'playtime_2weeks': None, 'rtime_last_played': 1648211167}, {'appid': 1172470, 'name': 'Apex Legends', 'playtime_forever': 3, 'playtime_2weeks': None, 'rtime_last_played': 1688458093}, {'appid': 298610, 'name': 'Ylands', 'playtime_forever': 7, 'playtime_2weeks': None, 'rtime_last_played': 1707580082}, {'appid': 1238840, 'name': 'Battlefield™ 1', 'playtime_forever': 1677, 'playtime_2weeks': None, 'rtime_last_played': 1742056735}, {'appid': 1290260, 'name': 'Dark Roll: Free Kick Challenge', 'playtime_forever': 8, 'playtime_2weeks': None, 'rtime_last_played': 1629196059}, {'appid': 1301720, 'name': 'Escape Room - The Sick Colleague', 'playtime_forever': 317, 'playtime_2weeks': None, 'rtime_last_played': 1696770719}, {'appid': 1326470, 'name': 'Sons Of The Forest', 'playtime_forever': 2474, 'playtime_2weeks': 782, 'rtime_last_played': 1753466505}, {'appid': 1088150, 'name': 'Scribble It!', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 843380, 'name': 'Super Animal Royale', 'playtime_forever': 70, 'playtime_2weeks': None, 'rtime_last_played': 1648229529}, {'appid': 1588400, 'name': "Spacelines from the Far Out - Captain's Prologue", 'playtime_forever': 237, 'playtime_2weeks': None, 'rtime_last_played': 1705850354}, {'appid': 1590320, 'name': 'Bro Falls: Ultimate Showdown', 'playtime_forever': 10, 'playtime_2weeks': None, 'rtime_last_played': 1665600811}, {'appid': 1568590, 'name': 'Goose Goose Duck', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 1029550, 'name': 'Torque Drift', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 264710, 'name': 'Subnautica', 'playtime_forever': 838, 'playtime_2weeks': None, 'rtime_last_played': 1734981917}, {'appid': 1665460, 'name': 'eFootball™', 'playtime_forever': 59, 'playtime_2weeks': None, 'rtime_last_played': 1737402241}, {'appid': 475550, 'name': 'Beholder', 'playtime_forever': 648, 'playtime_2weeks': None, 'rtime_last_played': 1636750199}, {'appid': 1782210, 'name': 'Crab Game', 'playtime_forever': 6, 'playtime_2weeks': None, 'rtime_last_played': 1637398463}, {'appid': 1818450, 'name': 'STALCRAFT: X', 'playtime_forever': 72, 'playtime_2weeks': None, 'rtime_last_played': 1690723185}, {'appid': 204450, 'name': 'Call of Juarez Gunslinger', 'playtime_forever': 11, 'playtime_2weeks': None, 'rtime_last_played': 1639156085}, {'appid': 1847520, 'name': 'HITMAN 3 Free Starter Pack', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 1850740, 'name': 'Ghost Watchers', 'playtime_forever': 381, 'playtime_2weeks': None, 'rtime_last_played': 1729968651}, {'appid': 1869590, 'name': 'Omega Strikers', 'playtime_forever': 12, 'playtime_2weeks': None, 'rtime_last_played': 1670004074}, {'appid': 578080, 'name': 'PUBG: BATTLEGROUNDS', 'playtime_forever': 35, 'playtime_2weeks': None, 'rtime_last_played': 1696683502}, {'appid': 1961460, 'name': 'Project Playtime', 'playtime_forever': 48, 'playtime_2weeks': None, 'rtime_last_played': 1688660838}, {'appid': 1977530, 'name': 'One-armed cook', 'playtime_forever': 67, 'playtime_2weeks': None, 'rtime_last_played': 1686232550}, {'appid': 2003310, 'name': 'Wallpaper Alive', 'playtime_forever': 360, 'playtime_2weeks': None, 'rtime_last_played': 1703266493}, {'appid': 2061440, 'name': 'Oxygen: First Breath', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2098350, 'name': 'Escape Memoirs: Mini Stories', 'playtime_forever': 149, 'playtime_2weeks': None, 'rtime_last_played': 1696780617}, {'appid': 552500, 'name': 'Warhammer: Vermintide 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2231380, 'name': 'Ghost Recon Breakpoint', 'playtime_forever': 17, 'playtime_2weeks': None, 'rtime_last_played': 1720604558}, {'appid': 2237980, 'name': 'Outpath: First Journey', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2289970, 'name': 'In Sink: A Co-Op Escape Prologue', 'playtime_forever': 93, 'playtime_2weeks': None, 'rtime_last_played': 1678131389}, {'appid': 2296990, 'name': 'We Were Here Expeditions: The FriendShip', 'playtime_forever': 391, 'playtime_2weeks': None, 'rtime_last_played': 1697914478}, {'appid': 493540, 'name': 'Figment', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 1712840, 'name': "Tiny Tina's Assault on Dragon Keep: A Wonderlands One-shot Adventure", 'playtime_forever': 234, 'playtime_2weeks': None, 'rtime_last_played': 1687354155}, {'appid': 582660, 'name': 'Black Desert', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 43160, 'name': 'Metro: Last Light Complete Edition', 'playtime_forever': 13, 'playtime_2weeks': None, 'rtime_last_played': 1719138454}, {'appid': 1180660, 'name': 'Tell Me Why', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2551020, 'name': 'One-armed robber', 'playtime_forever': 143, 'playtime_2weeks': None, 'rtime_last_played': 1740857037}, {'appid': 2595310, 'name': 'Pathless Woods: Prologue', 'playtime_forever': 3, 'playtime_2weeks': None, 'rtime_last_played': 1706982328}, {'appid': 2811830, 'name': 'Ocean World: Eden Crafters Prologue', 'playtime_forever': 63, 'playtime_2weeks': None, 'rtime_last_played': 1719495812}, {'appid': 420290, 'name': 'Blackwake', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2909110, 'name': 'Nuclear Nightmare', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2587450, 'name': 'Tank Team', 'playtime_forever': 35, 'playtime_2weeks': None, 'rtime_last_played': 1718986251}, {'appid': 1486630, 'name': 'Intravenous', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 442070, 'name': 'Drawful 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 2828500, 'name': 'The Jackbox Megapicker', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 1422450, 'name': 'Deadlock', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 3241660, 'name': 'R.E.P.O.', 'playtime_forever': 2593, 'playtime_2weeks': None, 'rtime_last_played': 1750441943}, {'appid': 2796010, 'name': 'Party Club', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 544610, 'name': 'Battlestar Galactica Deadlock', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': 0}, {'appid': 570, 'name': 'Dota 2', 'playtime_forever': 25943, 'playtime_2weeks': None, 'rtime_last_played': 1742753823}]}}
2025-07-28 15:36:31,337 - Tests - INFO - response: 200
2025-07-28 15:36:31,337 - Tests - INFO - {'user_data': {'player': {'steamid': 76561199054741771, 'personaname': 'RAT | Vaznia', 'avatarfull': 'https://avatars.steamstatic.com/756e958827d04652d0875b1995e3de3fa0721f25_full.jpg', 'personastate': 3, 'communityvisibilitystate': 3, 'profilestate': 1, 'lastlogoff': 1753704844, 'realname': None, 'primaryclanid': 103582791429521408, 'timecreated': 1588662836, 'timelive': 165043355.33000898, 'gameid': None, 'gameextrainfo': None, 'loccountrycode': None}}, 'user_friends_list': {'friends_count': 12, 'first_friend': {'steamid': '76561199028668211', 'relationship': 'friend', 'friend_since': 1670144518}, 'last_friend': {'steamid': '76561199015037292', 'relationship': 'friend', 'friend_since': 1751387588}, 'friends': [{'steamid': '76561199812673067', 'relationship': 'friend', 'friend_since': 1750759362}, {'steamid': '76561199224105477', 'relationship': 'friend', 'friend_since': 1692624302}, {'steamid': '76561199015037292', 'relationship': 'friend', 'friend_since': 1751387588}, {'steamid': '76561199226105875', 'relationship': 'friend', 'friend_since': 1686750681}, {'steamid': '76561199061382523', 'relationship': 'friend', 'friend_since': 1702669843}, {'steamid': '76561199028668211', 'relationship': 'friend', 'friend_since': 1670144518}, {'steamid': '76561199537985207', 'relationship': 'friend', 'friend_since': 1743103588}, {'steamid': '76561199088862470', 'relationship': 'friend', 'friend_since': 1708974374}, {'steamid': '76561199723441159', 'relationship': 'friend', 'friend_since': 1750759343}, {'steamid': '76561199508630158', 'relationship': 'friend', 'friend_since': 1702365021}, {'steamid': '76561199667157069', 'relationship': 'friend', 'friend_since': 1722688897}, {'steamid': '76561199171907697', 'relationship': 'friend', 'friend_since': 1751003803}]}, 'user_badges': {'badges': [{'badgeid': 13, 'level': 73, 'completion_time': 1752166122, 'xp': 284, 'scarcity': 25627787}, {'badgeid': 68, 'level': 1, 'completion_time': 1734589400, 'xp': 50, 'scarcity': 33683574}, {'badgeid': 67, 'level': 2, 'completion_time': 1732821517, 'xp': 50, 'scarcity': 4950713}, {'badgeid': 48, 'level': 5, 'completion_time': 1728882214, 'xp': 50, 'scarcity': 3679966}, {'badgeid': 2, 'level': 3, 'completion_time': 1703083900, 'xp': 500, 'scarcity': 11141651}, {'badgeid': 66, 'level': 1, 'completion_time': 1702968636, 'xp': 50, 'scarcity': 39186327}, {'badgeid': 64, 'level': 1, 'completion_time': 1672134283, 'xp': 50, 'scarcity': 78744514}, {'badgeid': 61, 'level': 3, 'completion_time': 1656760362, 'xp': 75, 'scarcity': 5024963}, {'badgeid': 1, 'level': 5, 'completion_time': 1588662836, 'xp': 250, 'scarcity': 216368139}, {'badgeid': 1, 'level': 1, 'completion_time': 1682172932, 'xp': 100, 'scarcity': 1386527}, {'badgeid': 1, 'level': 1, 'completion_time': 1703154035, 'xp': 100, 'scarcity': 13770547}, {'badgeid': 1, 'level': 1, 'completion_time': 1703154365, 'xp': 100, 'scarcity': 30195}, {'badgeid': 17, 'level': 1, 'completion_time': 1703870318, 'xp': 100, 'scarcity': 650680}], 'player_xp': 1759, 'player_level': 13, 'player_xp_needed_to_level_up': 41, 'player_xp_needed_current_level': 1600}, 'user_games': {'game_count': 126, 'games': [{'appid': 4000, 'name': "Garry's Mod", 'playtime_forever': 11641, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 550, 'name': 'Left 4 Dead 2', 'playtime_forever': 952, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 620, 'name': 'Portal 2', 'playtime_forever': 806, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 105600, 'name': 'Terraria', 'playtime_forever': 958, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 207610, 'name': 'The Walking Dead', 'playtime_forever': 1, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 204360, 'name': 'Castle Crashers', 'playtime_forever': 567, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 99900, 'name': 'Spiral Knights', 'playtime_forever': 119, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 236390, 'name': 'War Thunder', 'playtime_forever': 119, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 224260, 'name': 'No More Room in Hell', 'playtime_forever': 32, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 253710, 'name': 'theHunter Classic', 'playtime_forever': 135, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 242760, 'name': 'The Forest', 'playtime_forever': 4579, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 218620, 'name': 'PAYDAY 2', 'playtime_forever': 40, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 271590, 'name': 'Grand Theft Auto V Legacy', 'playtime_forever': 4071, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 3240220, 'name': 'Grand Theft Auto V Enhanced', 'playtime_forever': 32, 'playtime_2weeks': 32, 'rtime_last_played': None}, {'appid': 251570, 'name': '7 Days to Die', 'playtime_forever': 5196, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 284160, 'name': 'BeamNG.drive', 'playtime_forever': 727, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 312990, 'name': 'The Expendabros', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 333420, 'name': 'Cossacks 3', 'playtime_forever': 1907, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 365670, 'name': 'Blender', 'playtime_forever': 6853, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 322330, 'name': "Don't Starve Together", 'playtime_forever': 250, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 383150, 'name': 'Dead Island Definitive Edition', 'playtime_forever': 972, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 383180, 'name': 'Dead Island Riptide Definitive Edition', 'playtime_forever': 70, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 386940, 'name': 'Ultimate Chicken Horse', 'playtime_forever': 347, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 291550, 'name': 'Brawlhalla', 'playtime_forever': 4741, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 387990, 'name': 'Scrap Mechanic', 'playtime_forever': 5527, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 397900, 'name': 'Business Tour - Online Multiplayer Board Game', 'playtime_forever': 42, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 400080, 'name': 'Out of Space', 'playtime_forever': 45, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 359550, 'name': "Tom Clancy's Rainbow Six® Siege X", 'playtime_forever': 79, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 623990, 'name': "Tom Clancy's Rainbow Six Siege - Test Server", 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 431960, 'name': 'Wallpaper Engine', 'playtime_forever': 275, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 444090, 'name': 'Paladins', 'playtime_forever': 415, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 596350, 'name': 'Paladins - Public Test', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 471710, 'name': 'Rec Room', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 489830, 'name': 'The Elder Scrolls V: Skyrim Special Edition', 'playtime_forever': 106, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 289070, 'name': "Sid Meier's Civilization VI", 'playtime_forever': 43, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 292030, 'name': 'The Witcher 3: Wild Hunt', 'playtime_forever': 245, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 548430, 'name': 'Deep Rock Galactic', 'playtime_forever': 440, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 590830, 'name': 's&box', 'playtime_forever': 36, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 386180, 'name': 'Crossout', 'playtime_forever': 1224, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 648800, 'name': 'Raft', 'playtime_forever': 1094, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 304930, 'name': 'Unturned', 'playtime_forever': 5455, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 377160, 'name': 'Fallout 4', 'playtime_forever': 173, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 700330, 'name': 'SCP: Secret Laboratory', 'playtime_forever': 1446, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 629520, 'name': 'Soundpad', 'playtime_forever': 22565, 'playtime_2weeks': 2239, 'rtime_last_played': None}, {'appid': 766570, 'name': 'Russian Fishing 4', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 792220, 'name': 'Paunch', 'playtime_forever': 22, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 252490, 'name': 'Rust', 'playtime_forever': 90738, 'playtime_2weeks': 3225, 'rtime_last_played': None}, {'appid': 815370, 'name': 'Green Hell', 'playtime_forever': 590, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 552520, 'name': 'Far Cry 5', 'playtime_forever': 1970, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 312670, 'name': 'Strange Brigade', 'playtime_forever': 263, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 859570, 'name': 'Secret Neighbor', 'playtime_forever': 24, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 871720, 'name': 'Ultimate Custom Night', 'playtime_forever': 51, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 646910, 'name': 'The Crew 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 915320, 'name': 'Pixel Strike 3D', 'playtime_forever': 30, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 924970, 'name': 'Back 4 Blood', 'playtime_forever': 40, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 412020, 'name': 'Metro Exodus', 'playtime_forever': 1099, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1449560, 'name': 'Metro Exodus Enhanced Edition', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 730, 'name': 'Counter-Strike 2', 'playtime_forever': 73316, 'playtime_2weeks': 340, 'rtime_last_played': None}, {'appid': 993090, 'name': 'Lossless Scaling', 'playtime_forever': 161, 'playtime_2weeks': 65, 'rtime_last_played': None}, {'appid': 1004750, 'name': 'WRC 8 FIA World Rally Championship', 'playtime_forever': 185, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 812140, 'name': "Assassin's Creed Odyssey", 'playtime_forever': 1823, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1118200, 'name': 'People Playground', 'playtime_forever': 2880, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1128810, 'name': 'RISK: Global Domination', 'playtime_forever': 53, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1172470, 'name': 'Apex Legends', 'playtime_forever': 427, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1174180, 'name': 'Red Dead Redemption 2', 'playtime_forever': 7370, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1222580, 'name': 'Rustissimo', 'playtime_forever': 789, 'playtime_2weeks': 29, 'rtime_last_played': None}, {'appid': 1222700, 'name': 'A Way Out', 'playtime_forever': 646, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1238840, 'name': 'Battlefield™ 1', 'playtime_forever': 1723, 'playtime_2weeks': 1, 'rtime_last_played': None}, {'appid': 1249880, 'name': 'Tiny Bunny: Prologue', 'playtime_forever': 94, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1259420, 'name': 'Days Gone', 'playtime_forever': 2591, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1267540, 'name': 'WRC 9 FIA World Rally Championship', 'playtime_forever': 381, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1241100, 'name': 'POLYGON', 'playtime_forever': 237, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1326470, 'name': 'Sons Of The Forest', 'playtime_forever': 2548, 'playtime_2weeks': 792, 'rtime_last_played': None}, {'appid': 1238810, 'name': 'Battlefield™ V', 'playtime_forever': 1555, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1088150, 'name': 'Scribble It!', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 843380, 'name': 'Super Animal Royale', 'playtime_forever': 62, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1588400, 'name': "Spacelines from the Far Out - Captain's Prologue", 'playtime_forever': 238, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1598560, 'name': 'Life On A Pizza', 'playtime_forever': 2, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1568590, 'name': 'Goose Goose Duck', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1029550, 'name': 'Torque Drift', 'playtime_forever': 24, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 264710, 'name': 'Subnautica', 'playtime_forever': 962, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 663110, 'name': 'Sunrise survival', 'playtime_forever': 6, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 239140, 'name': 'Dying Light', 'playtime_forever': 208, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1070150, 'name': 'SLAYERS FOR HIRE', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 475550, 'name': 'Beholder', 'playtime_forever': 80, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1818450, 'name': 'STALCRAFT: X', 'playtime_forever': 235, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1818750, 'name': 'MultiVersus', 'playtime_forever': 62, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 204450, 'name': 'Call of Juarez Gunslinger', 'playtime_forever': 148, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1850740, 'name': 'Ghost Watchers', 'playtime_forever': 383, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 578080, 'name': 'PUBG: BATTLEGROUNDS', 'playtime_forever': 274, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1677740, 'name': 'Stumble Guys', 'playtime_forever': 34, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1961460, 'name': 'Project Playtime', 'playtime_forever': 25, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1977530, 'name': 'One-armed cook', 'playtime_forever': 135, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1721470, 'name': 'Poppy Playtime', 'playtime_forever': 37, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2003310, 'name': 'Wallpaper Alive', 'playtime_forever': 216, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 346110, 'name': 'ARK: Survival Evolved', 'playtime_forever': 608, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 407530, 'name': 'ARK: Survival Of The Fittest', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2073850, 'name': 'THE FINALS', 'playtime_forever': 1173, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 602770, 'name': 'Clatter', 'playtime_forever': 54, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1938090, 'name': 'Call of Duty®', 'playtime_forever': 89, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2237980, 'name': 'Outpath: First Journey', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2250040, 'name': 'Crosshair V2', 'playtime_forever': 9, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2289970, 'name': 'In Sink: A Co-Op Escape Prologue', 'playtime_forever': 93, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 493540, 'name': 'Figment', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1712840, 'name': "Tiny Tina's Assault on Dragon Keep: A Wonderlands One-shot Adventure", 'playtime_forever': 203, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 582660, 'name': 'Black Desert', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 226620, 'name': 'Desktop Dungeons', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2391710, 'name': 'Gatekeeper: Infinity', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 43160, 'name': 'Metro: Last Light Complete Edition', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 1180660, 'name': 'Tell Me Why', 'playtime_forever': 4, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 383270, 'name': 'Hue', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2466680, 'name': 'Kebab Simulator: Prologue', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2551020, 'name': 'One-armed robber', 'playtime_forever': 233, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 70, 'name': 'Half-Life', 'playtime_forever': 180, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2718190, 'name': 'Substance 3D Painter 2024', 'playtime_forever': 2730, 'playtime_2weeks': 1, 'rtime_last_played': None}, {'appid': 24010, 'name': 'Train Simulator Classic 2024', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2767030, 'name': 'Marvel Rivals', 'playtime_forever': 18, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2811830, 'name': 'Ocean World: Eden Crafters Prologue', 'playtime_forever': 62, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2909110, 'name': 'Nuclear Nightmare', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 2587450, 'name': 'Tank Team', 'playtime_forever': 22, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 3241660, 'name': 'R.E.P.O.', 'playtime_forever': 2881, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 220, 'name': 'Half-Life 2', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 320, 'name': 'Half-Life 2: Deathmatch', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 360, 'name': 'Half-Life Deathmatch: Source', 'playtime_forever': 0, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 440, 'name': 'Team Fortress 2', 'playtime_forever': 29, 'playtime_2weeks': None, 'rtime_last_played': None}, {'appid': 570, 'name': 'Dota 2', 'playtime_forever': 26152, 'playtime_2weeks': None, 'rtime_last_played': None}]}}
2025-07-28 15:36:32,249 - Tests - INFO - response: 404
2025-07-28 15:36:33,140 - Tests - INFO - response: 404
2025-07-28 15:37:00,687 - Tests - DEBUG - [{'name': 'Item 55', 'steam_appid': 55, 'final_formatted_price': '$14.99', 'discount': 78, 'short_description': 'This is a test description for Game 55.', 'img_url': 'https://cdn.fakeimage.com/game55.jpg', 'game_ganre': []}]
2025-07-28 15:37:01,523 - Tests - DEBUG - [{'name': 'Item 79', 'steam_appid': 79, 'final_formatted_price': '$29.99', 'discount': 55, 'short_description': 'This is a test description for Game 79.', 'img_url': 'https://cdn.fakeimage.com/game79.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 10', 'steam_appid': 10, 'final_formatted_price': '$54.99', 'discount': 53, 'short_description': 'This is a test description for Game 10.', 'img_url': 'https://cdn.fakeimage.com/game10.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 23', 'steam_appid': 23, 'final_formatted_price': '$18.99', 'discount': 38, 'short_description': 'This is a test description for Game 23.', 'img_url': 'https://cdn.fakeimage.com/game23.jpg', 'game_ganre': []}, {'name': 'Item 37', 'steam_appid': 37, 'final_formatted_price': '$30.99', 'discount': 50, 'short_description': 'This is a test description for Game 37.', 'img_url': 'https://cdn.fakeimage.com/game37.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 73', 'steam_appid': 73, 'final_formatted_price': '$33.99', 'discount': 51, 'short_description': 'This is a test description for Game 73.', 'img_url': 'https://cdn.fakeimage.com/game73.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 13', 'steam_appid': 13, 'final_formatted_price': '$58.99', 'discount': 51, 'short_description': 'This is a test description for Game 13.', 'img_url': 'https://cdn.fakeimage.com/game13.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 63', 'steam_appid': 63, 'final_formatted_price': '$22.99', 'discount': 1, 'short_description': 'This is a test description for Game 63.', 'img_url': 'https://cdn.fakeimage.com/game63.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 48', 'steam_appid': 48, 'final_formatted_price': '$52.99', 'discount': 16, 'short_description': 'This is a test description for Game 48.', 'img_url': 'https://cdn.fakeimage.com/game48.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 72', 'steam_appid': 72, 'final_formatted_price': '$48.99', 'discount': 64, 'short_description': 'This is a test description for Game 72.', 'img_url': 'https://cdn.fakeimage.com/game72.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 98', 'steam_appid': 98, 'final_formatted_price': '$33.99', 'discount': 13, 'short_description': 'This is a test description for Game 98.', 'img_url': 'https://cdn.fakeimage.com/game98.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}]
2025-07-28 15:37:02,347 - Tests - DEBUG - [{'name': 'Item 0', 'steam_appid': 0, 'final_formatted_price': '$30.99', 'discount': 21, 'short_description': 'This is a test description for Game 0.', 'img_url': 'https://cdn.fakeimage.com/game0.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 10, 'ganres_name': 'Random Ganre 9'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}]}, {'name': 'Item 1', 'steam_appid': 1, 'final_formatted_price': '$46.99', 'discount': 100, 'short_description': 'This is a test description for Game 1.', 'img_url': 'https://cdn.fakeimage.com/game1.jpg', 'game_ganre': [{'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 2', 'steam_appid': 2, 'final_formatted_price': '$29.99', 'discount': 43, 'short_description': 'This is a test description for Game 2.', 'img_url': 'https://cdn.fakeimage.com/game2.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 3', 'steam_appid': 3, 'final_formatted_price': '$8.99', 'discount': 68, 'short_description': 'This is a test description for Game 3.', 'img_url': 'https://cdn.fakeimage.com/game3.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}]}, {'name': 'Item 4', 'steam_appid': 4, 'final_formatted_price': '$32.99', 'discount': 86, 'short_description': 'This is a test description for Game 4.', 'img_url': 'https://cdn.fakeimage.com/game4.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 5', 'steam_appid': 5, 'final_formatted_price': '$16.99', 'discount': 8, 'short_description': 'This is a test description for Game 5.', 'img_url': 'https://cdn.fakeimage.com/game5.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}]}, {'name': 'Item 6', 'steam_appid': 6, 'final_formatted_price': '$23.99', 'discount': 30, 'short_description': 'This is a test description for Game 6.', 'img_url': 'https://cdn.fakeimage.com/game6.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 7', 'steam_appid': 7, 'final_formatted_price': '$50.99', 'discount': 77, 'short_description': 'This is a test description for Game 7.', 'img_url': 'https://cdn.fakeimage.com/game7.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 8', 'steam_appid': 8, 'final_formatted_price': '$47.99', 'discount': 55, 'short_description': 'This is a test description for Game 8.', 'img_url': 'https://cdn.fakeimage.com/game8.jpg', 'game_ganre': [{'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}]}, {'name': 'Item 9', 'steam_appid': 9, 'final_formatted_price': '$50.99', 'discount': 75, 'short_description': 'This is a test description for Game 9.', 'img_url': 'https://cdn.fakeimage.com/game9.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}]
2025-07-28 15:37:03,315 - Tests - DEBUG - [{'name': 'Item 0', 'steam_appid': 0, 'final_formatted_price': '$42.99', 'discount': 65, 'short_description': 'This is a test description for Game 0.', 'img_url': 'https://cdn.fakeimage.com/game0.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 1', 'steam_appid': 1, 'final_formatted_price': '$27.99', 'discount': 100, 'short_description': 'This is a test description for Game 1.', 'img_url': 'https://cdn.fakeimage.com/game1.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 2', 'steam_appid': 2, 'final_formatted_price': '$2.99', 'discount': 31, 'short_description': 'This is a test description for Game 2.', 'img_url': 'https://cdn.fakeimage.com/game2.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}]}, {'name': 'Item 3', 'steam_appid': 3, 'final_formatted_price': '$33.99', 'discount': 20, 'short_description': 'This is a test description for Game 3.', 'img_url': 'https://cdn.fakeimage.com/game3.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 4', 'steam_appid': 4, 'final_formatted_price': '$10.99', 'discount': 75, 'short_description': 'This is a test description for Game 4.', 'img_url': 'https://cdn.fakeimage.com/game4.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}]}, {'name': 'Item 5', 'steam_appid': 5, 'final_formatted_price': '$46.99', 'discount': 11, 'short_description': 'This is a test description for Game 5.', 'img_url': 'https://cdn.fakeimage.com/game5.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 6', 'steam_appid': 6, 'final_formatted_price': '$22.99', 'discount': 43, 'short_description': 'This is a test description for Game 6.', 'img_url': 'https://cdn.fakeimage.com/game6.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 7', 'steam_appid': 7, 'final_formatted_price': '$41.99', 'discount': 27, 'short_description': 'This is a test description for Game 7.', 'img_url': 'https://cdn.fakeimage.com/game7.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}]}, {'name': 'Item 8', 'steam_appid': 8, 'final_formatted_price': '$33.99', 'discount': 81, 'short_description': 'This is a test description for Game 8.', 'img_url': 'https://cdn.fakeimage.com/game8.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 9', 'steam_appid': 9, 'final_formatted_price': '$35.99', 'discount': 39, 'short_description': 'This is a test description for Game 9.', 'img_url': 'https://cdn.fakeimage.com/game9.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}]
2025-07-28 15:37:04,341 - Tests - DEBUG - [{'name': 'Item 0', 'steam_appid': 0, 'final_formatted_price': '$43.99', 'discount': 41, 'short_description': 'This is a test description for Game 0.', 'img_url': 'https://cdn.fakeimage.com/game0.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 1', 'steam_appid': 1, 'final_formatted_price': '$19.99', 'discount': 100, 'short_description': 'This is a test description for Game 1.', 'img_url': 'https://cdn.fakeimage.com/game1.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}]}, {'name': 'Item 2', 'steam_appid': 2, 'final_formatted_price': '$33.99', 'discount': 24, 'short_description': 'This is a test description for Game 2.', 'img_url': 'https://cdn.fakeimage.com/game2.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 3', 'steam_appid': 3, 'final_formatted_price': '$48.99', 'discount': 89, 'short_description': 'This is a test description for Game 3.', 'img_url': 'https://cdn.fakeimage.com/game3.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 10, 'ganres_name': 'Random Ganre 9'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 4', 'steam_appid': 4, 'final_formatted_price': '$22.99', 'discount': 47, 'short_description': 'This is a test description for Game 4.', 'img_url': 'https://cdn.fakeimage.com/game4.jpg', 'game_ganre': [{'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}]}, {'name': 'Item 5', 'steam_appid': 5, 'final_formatted_price': '$55.99', 'discount': 46, 'short_description': 'This is a test description for Game 5.', 'img_url': 'https://cdn.fakeimage.com/game5.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}]}, {'name': 'Item 6', 'steam_appid': 6, 'final_formatted_price': '$45.99', 'discount': 73, 'short_description': 'This is a test description for Game 6.', 'img_url': 'https://cdn.fakeimage.com/game6.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 7', 'steam_appid': 7, 'final_formatted_price': '$13.99', 'discount': 68, 'short_description': 'This is a test description for Game 7.', 'img_url': 'https://cdn.fakeimage.com/game7.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 8', 'steam_appid': 8, 'final_formatted_price': '$48.99', 'discount': 55, 'short_description': 'This is a test description for Game 8.', 'img_url': 'https://cdn.fakeimage.com/game8.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 9', 'steam_appid': 9, 'final_formatted_price': '$51.99', 'discount': 39, 'short_description': 'This is a test description for Game 9.', 'img_url': 'https://cdn.fakeimage.com/game9.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}]
2025-07-28 15:37:05,296 - Tests - DEBUG - [{'name': 'Item 25', 'steam_appid': 25, 'final_formatted_price': '$30.99', 'discount': 39, 'short_description': 'This is a test description for Game 25.', 'img_url': 'https://cdn.fakeimage.com/game25.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}]
2025-07-28 15:37:06,154 - Tests - DEBUG - [{'name': 'Item 0', 'steam_appid': 0, 'final_formatted_price': '$29.99', 'discount': 87, 'short_description': 'This is a test description for Game 0.', 'img_url': 'https://cdn.fakeimage.com/game0.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 1', 'steam_appid': 1, 'final_formatted_price': '$15.99', 'discount': 100, 'short_description': 'This is a test description for Game 1.', 'img_url': 'https://cdn.fakeimage.com/game1.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 3', 'steam_appid': 3, 'final_formatted_price': '$45.99', 'discount': 52, 'short_description': 'This is a test description for Game 3.', 'img_url': 'https://cdn.fakeimage.com/game3.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 5', 'steam_appid': 5, 'final_formatted_price': '$45.99', 'discount': 61, 'short_description': 'This is a test description for Game 5.', 'img_url': 'https://cdn.fakeimage.com/game5.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 7', 'steam_appid': 7, 'final_formatted_price': '$50.99', 'discount': 56, 'short_description': 'This is a test description for Game 7.', 'img_url': 'https://cdn.fakeimage.com/game7.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 8', 'steam_appid': 8, 'final_formatted_price': '$47.99', 'discount': 80, 'short_description': 'This is a test description for Game 8.', 'img_url': 'https://cdn.fakeimage.com/game8.jpg', 'game_ganre': [{'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}]}, {'name': 'Item 9', 'steam_appid': 9, 'final_formatted_price': '$29.99', 'discount': 79, 'short_description': 'This is a test description for Game 9.', 'img_url': 'https://cdn.fakeimage.com/game9.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}]}, {'name': 'Item 17', 'steam_appid': 17, 'final_formatted_price': '$40.99', 'discount': 52, 'short_description': 'This is a test description for Game 17.', 'img_url': 'https://cdn.fakeimage.com/game17.jpg', 'game_ganre': [{'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}]}, {'name': 'Item 21', 'steam_appid': 21, 'final_formatted_price': '$53.99', 'discount': 85, 'short_description': 'This is a test description for Game 21.', 'img_url': 'https://cdn.fakeimage.com/game21.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}]}, {'name': 'Item 24', 'steam_appid': 24, 'final_formatted_price': '$54.99', 'discount': 76, 'short_description': 'This is a test description for Game 24.', 'img_url': 'https://cdn.fakeimage.com/game24.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 9, 'ganres_name': 'Random Ganre 8'}, {'ganres_id': 10, 'ganres_name': 'Random Ganre 9'}]}]
2025-07-28 15:37:07,025 - Tests - DEBUG - []
2025-07-28 15:37:07,758 - Tests - DEBUG - [{'name': 'Item 23', 'steam_appid': 23, 'final_formatted_price': '$31.99', 'discount': 48, 'short_description': 'This is a test description for Game 23.', 'img_url': 'https://cdn.fakeimage.com/game23.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 31', 'steam_appid': 31, 'final_formatted_price': '$26.99', 'discount': 22, 'short_description': 'This is a test description for Game 31.', 'img_url': 'https://cdn.fakeimage.com/game31.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 8, 'ganres_name': 'Random Ganre 7'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}]}, {'name': 'Item 34', 'steam_appid': 34, 'final_formatted_price': '$60.99', 'discount': 55, 'short_description': 'This is a test description for Game 34.', 'img_url': 'https://cdn.fakeimage.com/game34.jpg', 'game_ganre': []}, {'name': 'Item 37', 'steam_appid': 37, 'final_formatted_price': '$37.99', 'discount': 78, 'short_description': 'This is a test description for Game 37.', 'img_url': 'https://cdn.fakeimage.com/game37.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 42', 'steam_appid': 42, 'final_formatted_price': '$59.99', 'discount': 83, 'short_description': 'This is a test description for Game 42.', 'img_url': 'https://cdn.fakeimage.com/game42.jpg', 'game_ganre': [{'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 43', 'steam_appid': 43, 'final_formatted_price': '$57.99', 'discount': 37, 'short_description': 'This is a test description for Game 43.', 'img_url': 'https://cdn.fakeimage.com/game43.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}, {'name': 'Item 46', 'steam_appid': 46, 'final_formatted_price': '$45.99', 'discount': 24, 'short_description': 'This is a test description for Game 46.', 'img_url': 'https://cdn.fakeimage.com/game46.jpg', 'game_ganre': [{'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 47', 'steam_appid': 47, 'final_formatted_price': '$19.99', 'discount': 65, 'short_description': 'This is a test description for Game 47.', 'img_url': 'https://cdn.fakeimage.com/game47.jpg', 'game_ganre': [{'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}]}, {'name': 'Item 51', 'steam_appid': 51, 'final_formatted_price': '$50.99', 'discount': 60, 'short_description': 'This is a test description for Game 51.', 'img_url': 'https://cdn.fakeimage.com/game51.jpg', 'game_ganre': [{'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}]}, {'name': 'Item 64', 'steam_appid': 64, 'final_formatted_price': '$18.99', 'discount': 79, 'short_description': 'This is a test description for Game 64.', 'img_url': 'https://cdn.fakeimage.com/game64.jpg', 'game_ganre': [{'ganres_id': 1, 'ganres_name': 'Random Ganre 0'}, {'ganres_id': 5, 'ganres_name': 'Random Ganre 4'}, {'ganres_id': 6, 'ganres_name': 'Random Ganre 5'}, {'ganres_id': 7, 'ganres_name': 'Random Ganre 6'}, {'ganres_id': 4, 'ganres_name': 'Random Ganre 3'}, {'ganres_id': 3, 'ganres_name': 'Random Ganre 2'}, {'ganres_id': 2, 'ganres_name': 'Random Ganre 1'}]}]
2025-07-28 15:37:08,637 - Tests - DEBUG - []
2025-07-28 15:37:09,435 - Tests - DEBUG - []
2025-07-28 15:37:10,185 - Tests - DEBUG - []
2025-07-28 16:06:07,081 - Tests - INFO - [x] Sent Message subscribe_queue
2025-07-28 16:06:07,081 - Tests - INFO - [x] Sent Message Body = {'type': 'update_steam_games', 'status': True}
2025-07-29 16:10:32,289 - Tests - ERROR - not all arguments converted during string formatting
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 1499, in __getattr__
    return getattr(self.comparator, key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Comparator' object has no attribute 'date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 472, in __getattr__
    return getattr(self.comparator, key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1332, in __getattr__
    return self._fallback_getattr(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\properties.py", line 472, in _fallback_getattr
    return getattr(self.__clause_element__(), key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 1501, in __getattr__
    raise AttributeError(
AttributeError: Neither 'AnnotatedColumn' object nor 'Comparator' object has an attribute 'date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 133, in dispathcher
    return self.dispatcher_command[func_name](*args,**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 113, in new_release
    return self.new_release_use_case.execute(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\usecases\subscribes_use_cases\new_release_use_case.py", line 14, in execute
    data = self.news_repository.new_release(session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\db\sync_repository\news_repository.py", line 85, in new_release
    Game.release_data.date==date.today(),
    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 474, in __getattr__
    raise AttributeError(
AttributeError: Neither 'InstrumentedAttribute' object nor 'Comparator' object associated with Game.release_data has an attribute 'date'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 32, in test_news_sender_to_queue
    news_task_creator(type_news=type_news)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\infrastructure\celery_app\tasks\news_tasks.py", line 23, in news_task_creator
    data = news_service.dispathcher(func_name=f"{type_news}",session=session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\application\services\news_service\news_service.py", line 137, in dispathcher
    self.logger.error("",e,exc_info=True)
  File "D:\FastAPI\steam_analitics\app\infrastructure\logger\logger.py", line 22, in error
    self.__logger.error(msg,*args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1568, in error
    self._log(ERROR, msg, args, **kwargs)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1684, in _log
    self.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1700, in handle
    self.callHandlers(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1762, in callHandlers
    hdlr.handle(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1028, in handle
    self.emit(record)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 386, in emit
    super().emit(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1168, in emit
    self.handleError(record)
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1160, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 999, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\_pytest\logging.py", line 139, in format
    return super().format(record)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 703, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 392, in getMessage
    msg = msg % self.args
          ~~~~^~~~~~~~~~~
TypeError: not all arguments converted during string formatting
2025-07-30 15:02:00,586 - Tests - ERROR - news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 52, in test_news_ganres_to_queue
    news_game_from_ganre.delay(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 444, in delay
    return self.apply_async(args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
2025-07-30 15:02:00,748 - Tests - ERROR - news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 52, in test_news_ganres_to_queue
    news_game_from_ganre.delay(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 444, in delay
    return self.apply_async(args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
2025-07-30 15:02:00,895 - Tests - ERROR - news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
Traceback (most recent call last):
  File "D:\FastAPI\steam_analitics\tests\test_celery_tasks.py", line 52, in test_news_ganres_to_queue
    news_game_from_ganre.delay(ganre_name=ganre_name)
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 444, in delay
    return self.apply_async(args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\FastAPI\steam_analitics\app\.venv\Lib\site-packages\celery\app\task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: news_game_from_ganre() got an unexpected keyword argument 'ganre_name'
